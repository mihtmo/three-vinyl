{"ast":null,"code":"import React, { createContext, useState, useRef, useCallback, useEffect, useContext } from 'react';\nimport { Canvas as Canvas$1 } from 'react-three-fiber';\nimport styled from 'styled-components';\nimport { useSpring, animated, to } from '@react-spring/web';\nimport { useDrag } from 'react-use-gesture';\nimport useMeasure from 'react-use-measure';\nimport { FileLoader } from 'three';\nimport { ChromePicker, TwitterPicker, SwatchesPicker, SliderPicker, SketchPicker, MaterialPicker, HuePicker, GithubPicker, CompactPicker, CirclePicker, BlockPicker, AlphaPicker } from 'react-color';\nimport { useSpring as useSpring$1 } from '@react-spring/three';\n\nfunction _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}\n\nfunction _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n\n  return target;\n}\n\nfunction _taggedTemplateLiteralLoose(strings, raw) {\n  if (!raw) {\n    raw = strings.slice(0);\n  }\n\n  strings.raw = raw;\n  return strings;\n}\n\nvar ControlsContext = /*#__PURE__*/createContext({\n  values: {\n    current: /*#__PURE__*/new Map()\n  },\n  gui: {\n    current: /*#__PURE__*/new Map()\n  },\n  state: {\n    current: /*#__PURE__*/new Map()\n  },\n  controls: [],\n  addControl: function addControl(control) {\n    return control;\n  },\n  removeControl: function removeControl() {}\n});\n\nvar ControlsProvider = function ControlsProvider(_ref) {\n  var children = _ref.children;\n\n  var _useState = useState([]),\n      controls = _useState[0],\n      setControls = _useState[1]; // Persist values between reloads\n\n\n  var values = useRef(new Map()); // GUI control state setters\n\n  var gui = useRef(new Map()); // useControl state setters\n\n  var state = useRef(new Map());\n  var context = {\n    values: values,\n    gui: gui,\n    state: state,\n    controls: controls,\n    addControl: function addControl(control) {\n      control.id = String(Math.random());\n      setControls(function (ctrls) {\n        // control.id = control.id ?? String(ctrls.length);\n        return [].concat(ctrls, [control]);\n      });\n      return control;\n    },\n    removeControl: function removeControl(ctrl) {\n      setControls(function (ctrls) {\n        return ctrls.filter(function (c) {\n          return c.id !== ctrl.id;\n        });\n      });\n    }\n  };\n  return React.createElement(ControlsContext.Provider, {\n    value: context\n  }, children);\n};\n\nfunction withControls(CanvasEl) {\n  return function (_ref2) {\n    var children = _ref2.children,\n        props = _objectWithoutPropertiesLoose(_ref2, [\"children\"]);\n\n    return React.createElement(ControlsContext.Consumer, null, function (value) {\n      return React.createElement(CanvasEl, Object.assign({}, props), React.createElement(ControlsContext.Provider, {\n        value: value\n      }, children));\n    });\n  };\n}\n\nvar Canvas = /*#__PURE__*/withControls(Canvas$1);\nvar DEFAULT_GROUP = 'DEFAULT_GROUP';\nvar ControlType;\n\n(function (ControlType) {\n  ControlType[\"NUMBER\"] = \"number\";\n  ControlType[\"STRING\"] = \"string\";\n  ControlType[\"BUTTON\"] = \"button\";\n  ControlType[\"BOOLEAN\"] = \"boolean\";\n  ControlType[\"SELECT\"] = \"select\";\n  ControlType[\"COLOR\"] = \"color\";\n  ControlType[\"XYPAD\"] = \"xypad\";\n  ControlType[\"FILE\"] = \"file\";\n  ControlType[\"CUSTOM\"] = \"custom\";\n})(ControlType || (ControlType = {}));\n\nvar defaultOptions = {\n  type: ControlType.NUMBER,\n  value: 0\n};\n\nvar defaultValue = function defaultValue(options) {\n  if (options.hasOwnProperty('value')) {\n    return options.value;\n  }\n\n  switch (options.type) {\n    case ControlType.NUMBER:\n      return 0;\n\n    case ControlType.COLOR:\n      return '#ff0000';\n\n    case ControlType.STRING:\n      return '';\n\n    case ControlType.SELECT:\n      return (options.items || [''])[0];\n\n    case ControlType.BOOLEAN:\n      return false;\n\n    case ControlType.FILE:\n      return new FileLoader();\n\n    case ControlType.XYPAD:\n      return {\n        x: 0,\n        y: 0\n      };\n  }\n\n  return undefined;\n};\n\nvar clamp = function clamp(num, _clamp, higher) {\n  return higher !== undefined ? Math.min(Math.max(num, _clamp), higher) : Math.min(num, _clamp);\n};\n\nvar map = function map(value, x1, y1, x2, y2) {\n  return (value - x1) * (y2 - x2) / (y1 - x1) + x2;\n};\n\nfunction useLocalStorage(key, initialValue) {\n  var _useState = useState(function () {\n    try {\n      var item = window.localStorage.getItem(key);\n      return item ? JSON.parse(item) : initialValue;\n    } catch (error) {\n      console.log(error);\n      return initialValue;\n    }\n  }),\n      storedValue = _useState[0],\n      setStoredValue = _useState[1];\n\n  var setValue = function setValue(value) {\n    try {\n      var valueToStore = value instanceof Function ? value(storedValue) : value;\n      setStoredValue(valueToStore);\n      window.localStorage.setItem(key, JSON.stringify(valueToStore));\n    } catch (error) {\n      console.log(error);\n    }\n  };\n\n  return [storedValue, setValue];\n}\n\nfunction _templateObject4() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  display: flex;\\n  font-family: sans-serif;\\n  white-space: nowrap;\\n  font-size: 14px;\\n  color: rgba(0, 0, 0, 0.75);\\n  justify-content: flex-end;\\n  \", \"\\n  \", \"\\n\"]);\n\n  _templateObject4 = function _templateObject4() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject3() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  display: flex;\\n  \", \"\\n  justify-content: flex-end;\\n  padding: 0 8px;\\n\"]);\n\n  _templateObject3 = function _templateObject3() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject2() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  display: flex;\\n  font-family: sans-serif;\\n  font-size: 14px;\\n  color: rgba(0, 0, 0, 0.4);\\n  width: 56px;\\n  user-select: none;\\n  \", \"\\n\"]);\n\n  _templateObject2 = function _templateObject2() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  display: flex;\\n  flex-direction: row;\\n  align-items: center;\\n  padding: 8px 0;\\n\"]);\n\n  _templateObject = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nvar Row = /*#__PURE__*/styled.div( /*#__PURE__*/_templateObject());\nvar Label = /*#__PURE__*/styled.label( /*#__PURE__*/_templateObject2(), function (props) {\n  return props.flexLabel === true ? 'flex: 1;' : '';\n});\nvar Content = /*#__PURE__*/styled.div( /*#__PURE__*/_templateObject3(), function (props) {\n  return props.flexLabel !== true ? 'flex: 1;' : '';\n});\nvar Value = /*#__PURE__*/styled.div( /*#__PURE__*/_templateObject4(), function (props) {\n  return props.stack ? 'flex: 1;' : '';\n}, function (props) {\n  return props.stack ? '' : 'width: 42px;';\n});\n\nfunction BaseControl(_ref) {\n  var htmlFor = _ref.htmlFor,\n      label = _ref.label,\n      flexLabel = _ref.flexLabel,\n      value = _ref.value,\n      stack = _ref.stack,\n      children = _ref.children;\n\n  if (stack) {\n    return React.createElement(\"div\", null, React.createElement(Row, null, React.createElement(Label, {\n      flexLabel: flexLabel\n    }, label), React.createElement(Value, {\n      stack: true,\n      flexLabel: flexLabel\n    }, value)), children);\n  }\n\n  return React.createElement(Row, null, React.createElement(Label, {\n    flexLabel: flexLabel,\n    htmlFor: htmlFor\n  }, label), React.createElement(Content, {\n    flexLabel: flexLabel\n  }, children), typeof value !== 'undefined' && React.createElement(Value, null, value));\n}\n\nfunction _templateObject$1() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  -webkit-appearance: none;\\n  width: 100%;\\n  background: transparent;\\n  display: inline-block;\\n\\n  &:focus {\\n    outline: none;\\n  }\\n\\n  &::-webkit-slider-runnable-track {\\n    width: 100%;\\n    height: 12px;\\n    cursor: pointer;\\n    background: rgba(0, 0, 0, 0.045);\\n    border-radius: 10px;\\n  }\\n\\n  &::-webkit-slider-thumb {\\n    border: none;\\n    height: 20px;\\n    width: 20px;\\n    border-radius: 50%;\\n    background: #ffffff;\\n    cursor: pointer;\\n    box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.22);\\n    -webkit-appearance: none;\\n    margin-top: -4px;\\n  }\\n\\n  &:focus::-webkit-slider-runnable-track {\\n    outline: none;\\n  }\\n\"]);\n\n  _templateObject$1 = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nvar InputRange = /*#__PURE__*/styled.input( /*#__PURE__*/_templateObject$1());\nvar PRECISION = 300;\nvar CENTER = PRECISION / 2;\n\nvar NumberControl = function NumberControl(_ref) {\n  var _options$distance;\n\n  var name = _ref.name,\n      value = _ref.value,\n      setValue = _ref.setValue,\n      options = _ref.options;\n  var ref = useRef(null);\n  var stage = useRef(null);\n  var _options$min = options.min,\n      min = _options$min === void 0 ? options.scrub ? -Infinity : 0 : _options$min,\n      _options$max = options.max,\n      max = _options$max === void 0 ? options.scrub ? Infinity : Math.PI : _options$max;\n  var distance = ((_options$distance = options.distance) !== null && _options$distance !== void 0 ? _options$distance : options.scrub) ? 2 : max - min;\n\n  var _useState = useState(options.scrub ? CENTER : map(value, min, max, 0, PRECISION)),\n      val = _useState[0],\n      setVal = _useState[1];\n\n  var handleChange = useCallback(function () {\n    if (options.scrub) {\n      setVal(CENTER);\n      stage.current = null;\n    }\n  }, [options.scrub]);\n  useEffect(function () {\n    var el = ref.current;\n\n    if (el) {\n      el.addEventListener('change', handleChange);\n    }\n\n    return function () {\n      if (el) {\n        el.removeEventListener('change', handleChange);\n      }\n    };\n  }, [handleChange, ref]);\n  return React.createElement(BaseControl, {\n    label: name,\n    value: (value || 0).toFixed(2)\n  }, React.createElement(InputRange, {\n    ref: ref,\n    type: \"range\",\n    value: val,\n    min: 0,\n    max: PRECISION,\n    onChange: function onChange(e) {\n      var num = Number(e.target.value);\n      setVal(num);\n\n      if (stage.current === null) {\n        stage.current = value;\n      }\n\n      var cvalue = (options.scrub ? stage.current : 0) + map(num - (options.scrub ? CENTER : 0), 0, PRECISION, options.scrub ? 0 : min, options.scrub ? distance * 2 : max);\n      setValue(clamp(cvalue, min, max));\n    }\n  }));\n};\n\nfunction _templateObject2$1() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  opacity: 0;\\n  margin-right: -15px;\\n  & + \", \":after {\\n    position: absolute;\\n    content: \\\"\\\";\\n    display: inline-block;\\n    height: 4px;\\n    width: 8px;\\n    border-left: 2px solid;\\n    border-bottom: 2px solid;\\n    left: 3px;\\n    top: 4px;\\n    opacity: 0;\\n    transform: translate(0px, 2px) rotate(-45deg);\\n    transition: ease-in-out 125ms;\\n    transition-property: opacity, transform;\\n  }\\n  &:checked + \", \":after {\\n    opacity: 1;\\n    transform: translate(0px, 0px) rotate(-45deg);\\n  }\\n  &:checked + \", \" {\\n    background: rgba(0, 0, 0, 0.045);\\n    border-color: rgba(0, 0, 0, 0.085);\\n  }\\n\"]);\n\n  _templateObject2$1 = function _templateObject2() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject$2() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  height: 16px;\\n  width: 16px;\\n  border: 2px solid rgba(0, 0, 0, 0.065);\\n  border-radius: 4px;\\n  position: relative;\\n  margin-top: -1px;\\n  transition: ease-in-out 125ms;\\n  transition-property: background-color, border-color;\\n\"]);\n\n  _templateObject$2 = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nvar FakeCheckbox = /*#__PURE__*/styled.label( /*#__PURE__*/_templateObject$2());\nvar Checkbox = /*#__PURE__*/styled.input( /*#__PURE__*/_templateObject2$1(), FakeCheckbox, FakeCheckbox, FakeCheckbox);\n\nfunction BooleanControl(_ref) {\n  var id = _ref.id,\n      name = _ref.name,\n      value = _ref.value,\n      setValue = _ref.setValue;\n  var htmlFor = \"Control\" + id;\n  return React.createElement(BaseControl, {\n    flexLabel: true,\n    label: name,\n    htmlFor: htmlFor\n  }, React.createElement(Checkbox, {\n    id: htmlFor,\n    type: \"checkbox\",\n    checked: value,\n    onChange: function onChange(e) {\n      return setValue(e.currentTarget.checked);\n    }\n  }), React.createElement(FakeCheckbox, {\n    htmlFor: htmlFor\n  }));\n}\n\nfunction _templateObject$3() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  display: block;\\n\\n  font-family: sans-serif;\\n  font-size: 14px;\\n  color: rgba(0, 0, 0, 0.4);\\n\\n  display: block;\\n  position: relative;\\n\\n  width: 100%;\\n  height: 32px;\\n\\n  color: #000;\\n\\n  border: 0;\\n  background-color: rgba(0, 0, 0, 0.045);\\n  border-radius: 4px;\\n  padding: 0 4px;\\n\"]);\n\n  _templateObject$3 = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nvar Button = /*#__PURE__*/styled.button( /*#__PURE__*/_templateObject$3());\n\nfunction ButtonControl(_ref) {\n  var name = _ref.name,\n      options = _ref.options;\n  return React.createElement(\"div\", {\n    style: {\n      paddingTop: 8,\n      paddingBottom: 8\n    }\n  }, React.createElement(Button, {\n    onClick: function onClick(e) {\n      if (options.onClick) {\n        options.onClick(e);\n      }\n    }\n  }, name));\n}\n\nfunction _templateObject3$1() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  position: absolute;\\n  top: 24px;\\n  right: 0px;\\n  z-index: 100;\\n\"]);\n\n  _templateObject3$1 = function _templateObject3() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject2$2() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  width: 32px;\\n  height: 16px;\\n  border: 2px solid white;\\n  box-shadow: 0 0 1px 0 rgba(0, 0, 0, 0.3);\\n  cursor: pointer;\\n\"]);\n\n  _templateObject2$2 = function _templateObject2() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject$4() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  position: relative;\\n\\n  > div {\\n    box-sizing: border-box !important;\\n  }\\n\"]);\n\n  _templateObject$4 = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nvar ColorPicker = /*#__PURE__*/styled.div( /*#__PURE__*/_templateObject$4());\nvar ColorBox = /*#__PURE__*/styled.div( /*#__PURE__*/_templateObject2$2());\nvar Picker = /*#__PURE__*/styled.div( /*#__PURE__*/_templateObject3$1());\n\nfunction ColorControl(_ref) {\n  var name = _ref.name,\n      value = _ref.value,\n      setValue = _ref.setValue,\n      options = _ref.options;\n  var _options$inline = options.inline,\n      inline = _options$inline === void 0 ? false : _options$inline,\n      _options$picker = options.picker,\n      picker = _options$picker === void 0 ? 'chrome' : _options$picker;\n\n  var _useState = useState(false),\n      open = _useState[0],\n      setOpen = _useState[1];\n\n  var pickerRef = useRef();\n\n  var handleClick = function handleClick(e) {\n    if (pickerRef.current && !pickerRef.current.contains(e.target)) {\n      setOpen(false);\n    }\n  };\n\n  useEffect(function () {\n    document.body.addEventListener('click', handleClick);\n    return function () {\n      document.body.removeEventListener('click', handleClick);\n    };\n  }, []);\n  var pickerProps = {\n    color: value,\n    onChange: function onChange(color) {\n      return setValue(color.rgb);\n    },\n    disableAlpha: options.disableAlpha,\n    colors: options.colors\n  };\n  var PickerElement = ChromePicker;\n\n  switch (picker) {\n    case 'alpha':\n      PickerElement = AlphaPicker;\n      break;\n\n    case 'block':\n      PickerElement = BlockPicker;\n      break;\n\n    case 'circle':\n      PickerElement = CirclePicker;\n      break;\n\n    case 'compact':\n      PickerElement = CompactPicker;\n      break;\n\n    case 'github':\n      PickerElement = GithubPicker;\n      break;\n\n    case 'hue':\n      PickerElement = HuePicker;\n      break;\n\n    case 'material':\n      PickerElement = MaterialPicker;\n      break;\n\n    case 'sketch':\n      PickerElement = SketchPicker;\n      pickerProps.presetColors = options.colors;\n      break;\n\n    case 'slider':\n      PickerElement = SliderPicker;\n      break;\n\n    case 'swatches':\n      PickerElement = SwatchesPicker;\n      break;\n\n    case 'twitter':\n      PickerElement = TwitterPicker;\n      break;\n  }\n\n  return React.createElement(BaseControl, {\n    stack: inline,\n    label: name,\n    flexLabel: true\n  }, React.createElement(ColorPicker, null, inline ? React.createElement(PickerElement, Object.assign({}, pickerProps, {\n    triangle: inline ? 'hide' : undefined,\n    width: 268\n  })) : React.createElement(React.Fragment, null, React.createElement(ColorBox, {\n    style: {\n      backgroundColor: value\n    },\n    onClick: function onClick() {\n      return setOpen(function (lastValue) {\n        return !lastValue;\n      });\n    }\n  }), React.createElement(Picker, {\n    hidden: open !== true,\n    ref: pickerRef\n  }, React.createElement(PickerElement, Object.assign({}, pickerProps))))));\n}\n\nfunction _templateObject$5() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  display: block;\\n\\n  font-family: sans-serif;\\n  font-size: 14px;\\n  color: rgba(0, 0, 0, 0.4);\\n\\n  display: block;\\n  position: relative;\\n\\n  width: 100%;\\n  height: 32px;\\n\\n  color: #000;\\n\\n  margin-left: 8px;\\n\\n  border: 0;\\n  background-color: rgba(0, 0, 0, 0.025);\\n  border-radius: 4px;\\n  padding: 0 4px;\\n\"]);\n\n  _templateObject$5 = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nvar Select = /*#__PURE__*/styled.select( /*#__PURE__*/_templateObject$5());\n\nfunction SelectControl(_ref) {\n  var name = _ref.name,\n      setValue = _ref.setValue,\n      value = _ref.value,\n      options = _ref.options;\n  var _options$items = options.items,\n      items = _options$items === void 0 ? [] : _options$items;\n  return React.createElement(BaseControl, {\n    label: name\n  }, React.createElement(Select, {\n    value: value,\n    onChange: function onChange(e) {\n      return setValue(e.currentTarget.value);\n    }\n  }, items.map(function (item, i) {\n    return React.createElement(\"option\", {\n      key: i\n    }, item);\n  })));\n}\n\nfunction _templateObject$6() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  display: block;\\n\\n  font-family: sans-serif;\\n  font-size: 14px;\\n  color: rgba(0, 0, 0, 0.4);\\n\\n  display: block;\\n  position: relative;\\n\\n  width: 100%;\\n  height: 32px;\\n\\n  color: #000;\\n\\n  margin-left: 8px;\\n\\n  border: 0;\\n  background-color: rgba(0, 0, 0, 0.025);\\n  border-radius: 4px;\\n  padding: 0 4px;\\n\"]);\n\n  _templateObject$6 = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nvar Input = /*#__PURE__*/styled.input( /*#__PURE__*/_templateObject$6());\nvar StringControl = /*#__PURE__*/React.memo(function (_ref) {\n  var name = _ref.name,\n      setValue = _ref.setValue,\n      value = _ref.value;\n  return React.createElement(BaseControl, {\n    label: name\n  }, React.createElement(Input, {\n    value: value,\n    onChange: function onChange(e) {\n      return setValue(e.target.value);\n    }\n  }));\n});\nvar THRESHOLD = 0.00001;\n\nvar XYPadControl = function XYPadControl(_ref) {\n  var name = _ref.name,\n      value = _ref.value,\n      setValue = _ref.setValue,\n      options = _ref.options;\n  var stage = useRef(null);\n  var _options$distance = options.distance,\n      distance = _options$distance === void 0 ? 1 : _options$distance,\n      _options$scrub = options.scrub,\n      scrub = _options$scrub === void 0 ? false : _options$scrub;\n\n  var _useMeasure = useMeasure(),\n      ref = _useMeasure[0],\n      _useMeasure$ = _useMeasure[1],\n      width = _useMeasure$.width,\n      height = _useMeasure$.height;\n\n  var _useSpring = useSpring(function () {\n    return {\n      from: {\n        x: value.x,\n        y: value.y\n      },\n      onChange: function onChange(value, b) {\n        var clampMx = b.key === 'x' ? width : height;\n        var v = clamp(map(value, 0, clampMx / 2, 0, distance), -distance, distance) || 0;\n\n        if (!scrub) {\n          setValue(function (prev) {\n            var _extends2;\n\n            return _extends({}, prev, (_extends2 = {}, _extends2[b.key] = v < THRESHOLD && v > -THRESHOLD ? 0 : v, _extends2));\n          });\n        }\n      }\n    };\n  }, [width, height]),\n      cursor = _useSpring[0],\n      setCursor = _useSpring[1];\n\n  var bind = useDrag(function (_ref2) {\n    var down = _ref2.down,\n        movement = _ref2.movement;\n\n    if (down && !stage.current) {\n      stage.current = value;\n    } else if (!down) {\n      stage.current = null;\n    }\n\n    setCursor({\n      x: down ? movement[0] : 0,\n      y: down ? movement[1] : 0\n    });\n\n    if (scrub) {\n      if (down) {\n        setValue(function () {\n          return {\n            x: stage.current.x + map(movement[0], 0, width / 2, 0, distance),\n            y: stage.current.y + map(movement[1], 0, height / 2, 0, distance)\n          };\n        });\n      } else {\n        stage.current = value;\n      }\n    }\n  });\n  var x = cursor.x.to(function (n) {\n    return clamp(n + width / 2, 0, width);\n  });\n  var y = cursor.y.to(function (n) {\n    return clamp(n + height / 2, 0, height);\n  });\n  return React.createElement(BaseControl, {\n    stack: true,\n    label: name,\n    value: \"x: \" + value.x.toFixed(1) + \", y: \" + value.y.toFixed(1)\n  }, React.createElement(animated.svg, Object.assign({\n    ref: ref,\n    style: {\n      userSelect: 'none',\n      borderRadius: 8,\n      border: '1px solid #f0f0f0'\n    },\n    width: \"100%\",\n    height: 200,\n    xmlns: \"http://www.w3.org/2000/svg\"\n  }, bind()), React.createElement(\"rect\", {\n    fill: \"rgb(250, 250, 250)\",\n    width: \"100%\",\n    height: \"100%\"\n  }), React.createElement(animated.line, {\n    x1: x,\n    x2: x,\n    y1: 0,\n    y2: \"100%\",\n    stroke: \"#ccc\"\n  }), React.createElement(animated.line, {\n    x1: 0,\n    x2: \"100%\",\n    y1: y,\n    y2: y,\n    stroke: \"#ccc\"\n  }), React.createElement(animated.g, {\n    style: {\n      transform: to([x, y], function (x, y) {\n        return \"translate(\" + x + \"px, \" + y + \"px)\";\n      })\n    }\n  }, React.createElement(\"circle\", {\n    r: 8,\n    fill: \"#ccc\"\n  }), React.createElement(\"circle\", {\n    r: 4,\n    fill: \"#aaa\"\n  }))));\n};\n\nfunction _templateObject$7() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  width: 100%;\\n\"]);\n\n  _templateObject$7 = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nvar FileInput = /*#__PURE__*/styled.input( /*#__PURE__*/_templateObject$7());\n\nvar FileControl = function FileControl(_ref) {\n  var name = _ref.name,\n      setValue = _ref.setValue,\n      options = _ref.options;\n  return React.createElement(BaseControl, {\n    label: name\n  }, React.createElement(FileInput, {\n    type: \"file\",\n    onChange: function onChange(e) {\n      var _options$loader;\n\n      var loader = (_options$loader = options.loader) !== null && _options$loader !== void 0 ? _options$loader : new FileLoader();\n\n      if (loader.setCrossOrigin) {\n        loader.setCrossOrigin('');\n      }\n\n      var file = e.currentTarget.files && e.currentTarget.files[0];\n      var texture = loader.load(URL.createObjectURL(file));\n      setValue(texture);\n    }\n  }));\n};\n\nvar _ControlComponents;\n\nvar ControlComponents = (_ControlComponents = {}, _ControlComponents[ControlType.NUMBER] = NumberControl, _ControlComponents[ControlType.BOOLEAN] = BooleanControl, _ControlComponents[ControlType.SELECT] = SelectControl, _ControlComponents[ControlType.COLOR] = ColorControl, _ControlComponents[ControlType.STRING] = StringControl, _ControlComponents[ControlType.BUTTON] = ButtonControl, _ControlComponents[ControlType.FILE] = FileControl, _ControlComponents[ControlType.XYPAD] = XYPadControl, _ControlComponents);\n\nvar Noop = function Noop(_ref) {\n  var name = _ref.name,\n      options = _ref.options;\n  return React.createElement(BaseControl, {\n    label: name\n  }, \"\\\"\", options.type, \"\\\" not found\");\n};\n\nvar ControlItem = function ControlItem(_ref2) {\n  var _ref3, _options$component, _options$type;\n\n  var name = _ref2.name,\n      id = _ref2.id,\n      defaultValue = _ref2.value,\n      options = _ref2.options;\n  var context = useContext(ControlsContext);\n\n  var _useState = useState(context.values.current && context.values.current.has(id) ? context.values.current.get(id) : defaultValue),\n      value = _useState[0],\n      setValue = _useState[1];\n\n  useEffect(function () {\n    context.values.current.set(id, value);\n  }, [context.values, id, value]);\n  useEffect(function () {\n    context.gui.current.set(id, setValue);\n  }, [context.gui, id]);\n  var Component = (_ref3 = (_options$component = options.component) !== null && _options$component !== void 0 ? _options$component : ControlComponents[(_options$type = options.type) !== null && _options$type !== void 0 ? _options$type : ControlType.NUMBER]) !== null && _ref3 !== void 0 ? _ref3 : Noop;\n  return React.createElement(Component, {\n    id: id,\n    name: name,\n    value: value,\n    setValue: function setValue(newValue) {\n      var _context$gui$current, _context$gui$current$, _context$state$curren, _context$state$curren2;\n\n      (_context$gui$current = context.gui.current) === null || _context$gui$current === void 0 ? void 0 : (_context$gui$current$ = _context$gui$current.get(id)) === null || _context$gui$current$ === void 0 ? void 0 : _context$gui$current$(newValue);\n      (_context$state$curren = context.state.current) === null || _context$state$curren === void 0 ? void 0 : (_context$state$curren2 = _context$state$curren.get(id)) === null || _context$state$curren2 === void 0 ? void 0 : _context$state$curren2(newValue);\n    },\n    options: options\n  });\n};\n\nfunction _templateObject2$3() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  background: \", \";\\n  padding: 16px;\\n  display: \", \";\\n  margin-bottom: 8px;\\n\"]);\n\n  _templateObject2$3 = function _templateObject2() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject$8() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  display: block;\\n  font-family: sans-serif;\\n  font-size: 13px;\\n  font-weight: bold;\\n  padding-left: 16px;\\n  cursor: pointer;\\n  position: relative;\\n  user-select: none;\\n\\n  &:before,\\n  &:after {\\n    content: '';\\n    position: absolute;\\n    top: 8px;\\n    right: 16px;\\n    width: 12px;\\n    height: 2px;\\n    background-color: #333;\\n    /* transition: transform 0.25s ease-out; */\\n  }\\n  &:before {\\n    transform: rotate(\", \"deg);\\n  }\\n\\n  &:after {\\n    transform: rotate(\", \"deg);\\n  }\\n\"]);\n\n  _templateObject$8 = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nvar Heading = /*#__PURE__*/styled.h2( /*#__PURE__*/_templateObject$8(), function (props) {\n  return props.open ? 0 : 90;\n}, function (props) {\n  return props.open ? 0 : 180;\n});\nvar Container = /*#__PURE__*/styled.div( /*#__PURE__*/_templateObject2$3(), function (props) {\n  return props.bg ? '#f9f9f9' : '#fff';\n}, function (props) {\n  return props.open ? 'block' : 'none';\n});\n\nvar ControlGroup = function ControlGroup(_ref) {\n  var _options$defaultClose;\n\n  var title = _ref.title,\n      controls = _ref.controls,\n      _ref$options = _ref.options,\n      options = _ref$options === void 0 ? {} : _ref$options;\n\n  var _useState = useState((_options$defaultClose = !options.defaultClosed) !== null && _options$defaultClose !== void 0 ? _options$defaultClose : true),\n      open = _useState[0],\n      setOpen = _useState[1];\n\n  var isDefault = title !== 'DEFAULT_GROUP';\n  return React.createElement(\"div\", null, isDefault && React.createElement(Heading, {\n    open: open,\n    onClick: function onClick() {\n      return setOpen(function (o) {\n        return !o;\n      });\n    }\n  }, title), React.createElement(Container, {\n    open: open,\n    bg: isDefault\n  }, Array.from(controls).map(function (control) {\n    return React.createElement(ControlItem, Object.assign({\n      key: control.id + \"_\" + control.name\n    }, control));\n  })));\n};\n\nfunction _templateObject4$1() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  padding-bottom: 8px;\\n  overflow-y: auto;\\n  max-height: calc(100vh - 42px);\\n\"]);\n\n  _templateObject4$1 = function _templateObject4() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject3$2() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  width: 30px;\\n  height: 18px;\\n  display: flex;\\n  align-items: center;\\n  justify-content: center;\\n  margin-left: auto;\\n  cursor: pointer;\\n  &:after {\\n    content: '';\\n    display: block;\\n    height: 3px;\\n    width: 16px;\\n    background-color: white;\\n  }\\n  \", \" {\\n    &:before {\\n      content: '';\\n      display: block;\\n      position: absolute;\\n      top: 0;\\n      right: 0;\\n      bottom: 0;\\n      left: 0;\\n    }\\n  }\\n\"]);\n\n  _templateObject3$2 = function _templateObject3() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject2$4() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  display: flex;\\n  align-items: center;\\n  position: relative;\\n  padding-left: 16px;\\n  padding-right: 16px;\\n  height: 42px;\\n  font-family: sans-serif;\\n  font-size: 14px;\\n  color: #fff;\\n  cursor: move;\\n  cursor: grab;\\n  user-select: none;\\n  background-color: #000;\\n  border-top-left-radius: 8px;\\n  border-top-right-radius: 8px;\\n  border-bottom-left-radius: \", \"px;\\n  border-bottom-right-radius: \", \"px;\\n  box-shadow: 0 0 14px 0 rgba(0, 0, 0, 0.14);\\n  \", \" {\\n    border-top-left-radius: 0px;\\n    border-top-right-radius: 0px;\\n    border-bottom-left-radius: 0px;\\n    border-bottom-right-radius: 0px;\\n  }\\n\"]);\n\n  _templateObject2$4 = function _templateObject2() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject$9() {\n  var data = _taggedTemplateLiteralLoose([\"\\n  display: flex;\\n  flex-direction: column;\\n  position: fixed;\\n  top: \", \";\\n  right: \", \";\\n  bottom: \", \";\\n  left: \", \";\\n  width: \", \"px;\\n  border-radius: 16px;\\n  background-color: #fff;\\n  border-radius: 8px;\\n  box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.12);\\n\\n  \", \" {\\n    transform: none !important;\\n    flex-direction: column-reverse;\\n    top: auto;\\n    bottom: 0;\\n    left: 0;\\n    right: 0;\\n    width: auto;\\n  }\\n\"]);\n\n  _templateObject$9 = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nvar mq = \"@media only screen and (max-width: 600px)\";\nvar ControlsAnchor;\n\n(function (ControlsAnchor) {\n  ControlsAnchor[\"TOP_LEFT\"] = \"top_left\";\n  ControlsAnchor[\"TOP_RIGHT\"] = \"top_right\";\n  ControlsAnchor[\"BOTTOM_LEFT\"] = \"bottom_left\";\n  ControlsAnchor[\"BOTTOM_RIGHT\"] = \"bottom_right\";\n})(ControlsAnchor || (ControlsAnchor = {}));\n\nfunction posProps(positions) {\n  return function posPropsFn(props) {\n    return positions.includes(props['data-anchor']) ? '16px' : 'auto';\n  };\n}\n\nvar Float = /*#__PURE__*/styled(animated.div)( /*#__PURE__*/_templateObject$9(), /*#__PURE__*/posProps([ControlsAnchor.TOP_LEFT, ControlsAnchor.TOP_RIGHT]), /*#__PURE__*/posProps([ControlsAnchor.BOTTOM_RIGHT, ControlsAnchor.TOP_RIGHT]), /*#__PURE__*/posProps([ControlsAnchor.BOTTOM_RIGHT, ControlsAnchor.BOTTOM_LEFT]), /*#__PURE__*/posProps([ControlsAnchor.TOP_LEFT, ControlsAnchor.BOTTOM_LEFT]), function (props) {\n  return props['data-width'];\n}, mq);\nvar Header = /*#__PURE__*/styled(animated.div)( /*#__PURE__*/_templateObject2$4(), function (props) {\n  return props['data-collapsed'] ? 0 : 8;\n}, function (props) {\n  return props['data-collapsed'] ? 0 : 8;\n}, mq);\nvar CollapseIcon = /*#__PURE__*/styled.div( /*#__PURE__*/_templateObject3$2(), mq);\nvar Items = /*#__PURE__*/styled(animated.div)( /*#__PURE__*/_templateObject4$1());\n\nvar groupByGroup = function groupByGroup(items) {\n  return Array.from(items).reduce(function (acc, item) {\n    var _item$options;\n\n    var groupName = (item === null || item === void 0 ? void 0 : (_item$options = item.options) === null || _item$options === void 0 ? void 0 : _item$options.group) || DEFAULT_GROUP;\n    acc[groupName] = acc[groupName] || [];\n    acc[groupName].push(item);\n    return acc;\n  }, {});\n};\n\nvar Controls = function Controls(props) {\n  var _props$title = props.title,\n      title = _props$title === void 0 ? 'react-three-gui' : _props$title,\n      _props$defaultClosedG = props.defaultClosedGroups,\n      defaultClosedGroups = _props$defaultClosedG === void 0 ? [] : _props$defaultClosedG,\n      _props$width = props.width,\n      width = _props$width === void 0 ? 300 : _props$width,\n      _props$style = props.style,\n      style = _props$style === void 0 ? {} : _props$style,\n      _props$anchor = props.anchor,\n      anchor = _props$anchor === void 0 ? ControlsAnchor.TOP_RIGHT : _props$anchor;\n\n  var _useContext = useContext(ControlsContext),\n      controls = _useContext.controls;\n\n  var _useLocalStorage = useLocalStorage('REACT_THREE_GUI__COLLAPSED', props.collapsed),\n      collapsed = _useLocalStorage[0],\n      setCollapsed = _useLocalStorage[1];\n\n  var _useLocalStorage2 = useLocalStorage(\"REACT_THREE_GUI__\" + anchor, [0, 0]),\n      position = _useLocalStorage2[0],\n      setPosition = _useLocalStorage2[1];\n\n  var _useMeasure = useMeasure(),\n      ref = _useMeasure[0],\n      bounds = _useMeasure[1];\n\n  var _useSpring = useSpring(function () {\n    return {\n      pos: position,\n      onRest: function onRest(_ref) {\n        var value = _ref.value;\n        setPosition(value);\n      }\n    };\n  }),\n      pos = _useSpring[0].pos,\n      setPos = _useSpring[1];\n\n  var left = [ControlsAnchor.TOP_LEFT, ControlsAnchor.BOTTOM_LEFT].includes(anchor);\n  var top = [ControlsAnchor.TOP_RIGHT, ControlsAnchor.TOP_LEFT].includes(anchor);\n  var bind = useDrag(function (_ref2) {\n    var movement = _ref2.movement,\n        _ref2$memo = _ref2.memo,\n        memo = _ref2$memo === void 0 ? pos ? pos.getValue ? pos.getValue() : pos.get() : 0 : _ref2$memo;\n    var x = movement[0] + memo[0],\n        y = movement[1] + memo[1];\n    setPos({\n      pos: [left ? clamp(x, 1, window.innerWidth - width - 32) : clamp(x, -window.innerWidth + width + 32, 1), top ? clamp(y, 1, window.innerHeight) : clamp(y, -window.innerHeight + bounds.height + 32, 1)]\n    });\n    return memo;\n  });\n\n  var getGroupOptions = function getGroupOptions(groupName) {\n    var _defaultClosedGroups$;\n\n    return {\n      defaultClosed: (_defaultClosedGroups$ = defaultClosedGroups === null || defaultClosedGroups === void 0 ? void 0 : defaultClosedGroups.includes(groupName)) !== null && _defaultClosedGroups$ !== void 0 ? _defaultClosedGroups$ : false\n    };\n  };\n\n  var groups = groupByGroup(controls);\n  return React.createElement(Float, {\n    \"data-width\": width,\n    \"data-anchor\": anchor,\n    ref: ref,\n    style: _extends({}, style, {\n      transform: to([pos], function (_ref3) {\n        var x = _ref3[0],\n            y = _ref3[1];\n        return \"translate3d(\" + x + \"px,\" + y + \"px,0)\";\n      })\n    })\n  }, React.createElement(Header, Object.assign({\n    \"data-collapsed\": collapsed\n  }, bind()), title, React.createElement(CollapseIcon, {\n    collapsed: collapsed,\n    onClick: function onClick() {\n      return setCollapsed(function (c) {\n        return !c;\n      });\n    }\n  })), React.createElement(Items, {\n    hidden: !collapsed,\n    style: {\n      maxHeight: top ? to([pos], function (_ref4) {\n        var y = _ref4[1];\n        return \"calc(100vh - \" + (y + 92) + \"px)\";\n      }) : undefined\n    }\n  }, Object.entries(groups).map(function (_ref5) {\n    var groupName = _ref5[0],\n        items = _ref5[1];\n    return React.createElement(ControlGroup, {\n      key: groupName,\n      title: groupName,\n      controls: items,\n      options: getGroupOptions(groupName)\n    });\n  })));\n};\n\nControls.Provider = ControlsProvider;\nControls.Canvas = Canvas;\n\nvar useControl = function useControl(name, options) {\n  if (options === void 0) {\n    options = defaultOptions;\n  }\n\n  var context = useContext(ControlsContext);\n\n  var _useState = useState(null),\n      id = _useState[0],\n      setId = _useState[1];\n\n  var _useState2 = useState(defaultValue(options)),\n      value = _useState2[0],\n      setValue = _useState2[1];\n\n  var _useSpring = useSpring$1(function () {\n    return {\n      value: value,\n      config: typeof options.spring === 'object' ? options.spring : undefined\n    };\n  }),\n      spring = _useSpring[0],\n      setSpring = _useSpring[1];\n\n  var setSpringValue = function setSpringValue(springValue) {\n    return setSpring({\n      value: springValue\n    });\n  };\n\n  if (options.state) {\n    value = options.state[0];\n    setValue = options.state[1];\n  }\n\n  useEffect(function () {\n    if (context.state.current && id) {\n      if (options.spring) {\n        context.state.current.set(id, setSpringValue);\n      } else {\n        context.state.current.set(id, setValue);\n      }\n    }\n  }, [context.state, id]);\n  useEffect(function () {\n    var ctrl = context.addControl({\n      id: options.id,\n      name: name,\n      value: value,\n      options: options\n    });\n    setId(ctrl.id);\n    return function () {\n      context.removeControl(ctrl);\n    };\n  }, []);\n  useEffect(function () {\n    options.spring && void setSpring({\n      value: value\n    });\n    options.onChange && void options.onChange(value);\n  }, [options, setSpring, value]);\n\n  if (options.spring) {\n    return spring.value;\n  }\n\n  return value;\n};\n\nexport { BaseControl, ControlType, Controls, ControlsContext, DEFAULT_GROUP, useControl, withControls };","map":{"version":3,"mappings":"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","names":["ControlsContext","createContext","values","current","Map","gui","state","controls","addControl","control","removeControl","ControlsProvider","children","useState","setControls","useRef","context","id","String","Math","random","ctrls","ctrl","filter","c","React","Provider","value","withControls","CanvasEl","props","Consumer","Canvas","R3FCanvas","DEFAULT_GROUP","ControlType","defaultOptions","type","NUMBER","defaultValue","options","hasOwnProperty","COLOR","STRING","SELECT","items","BOOLEAN","FILE","THREE","XYPAD","x","y","undefined","clamp","num","higher","min","max","map","x1","y1","x2","y2","useLocalStorage","key","initialValue","item","window","localStorage","getItem","JSON","parse","error","console","log","storedValue","setStoredValue","setValue","valueToStore","Function","setItem","stringify","Row","styled","div","Label","label","flexLabel","Content","Value","stack","BaseControl","htmlFor","InputRange","input","PRECISION","CENTER","NumberControl","name","ref","stage","scrub","Infinity","_options$min","PI","distance","val","setVal","handleChange","useCallback","useEffect","el","addEventListener","removeEventListener","toFixed","onChange","Number","e","target","cvalue","FakeCheckbox","Checkbox","BooleanControl","checked","currentTarget","Button","button","ButtonControl","style","paddingTop","paddingBottom","onClick","ColorPicker","ColorBox","Picker","ColorControl","inline","_options$inline","picker","_options$picker","open","setOpen","pickerRef","handleClick","contains","document","body","pickerProps","color","rgb","disableAlpha","colors","PickerElement","ChromePicker","AlphaPicker","BlockPicker","CirclePicker","CompactPicker","GithubPicker","HuePicker","MaterialPicker","SketchPicker","presetColors","SliderPicker","SwatchesPicker","TwitterPicker","triangle","width","backgroundColor","lastValue","hidden","Select","select","SelectControl","_options$items","i","Input","StringControl","memo","THRESHOLD","XYPadControl","_options$distance","_options$scrub","useMeasure","height","useSpring","from","b","clampMx","v","prev","cursor","setCursor","bind","useDrag","down","movement","to","n","animated","svg","userSelect","borderRadius","border","xmlns","fill","line","stroke","g","transform","r","FileInput","FileControl","loader","setCrossOrigin","file","files","texture","load","URL","createObjectURL","ControlComponents","BUTTON","Noop","ControlItem","useContext","has","get","set","Component","component","newValue","Heading","h2","Container","bg","ControlGroup","title","_ref$options","defaultClosed","isDefault","o","Array","mq","ControlsAnchor","posProps","positions","posPropsFn","includes","Float","TOP_LEFT","TOP_RIGHT","BOTTOM_RIGHT","BOTTOM_LEFT","Header","CollapseIcon","Items","groupByGroup","reduce","acc","groupName","group","push","Controls","_props$title","defaultClosedGroups","_props$defaultClosedG","_props$width","_props$style","anchor","collapsed","setCollapsed","position","setPosition","bounds","pos","onRest","setPos","left","top","getValue","_ref2$memo","innerWidth","innerHeight","getGroupOptions","groups","maxHeight","Object","entries","useControl","setId","config","spring","setSpring","setSpringValue","springValue"],"sources":["/Users/mitch/Desktop/My Computer/Coding Projects/three-vinyl/node_modules/react-three-gui/src/contexts/controls-context.ts","/Users/mitch/Desktop/My Computer/Coding Projects/three-vinyl/node_modules/react-three-gui/src/components/controls-provider.tsx","/Users/mitch/Desktop/My Computer/Coding Projects/three-vinyl/node_modules/react-three-gui/src/types.ts","/Users/mitch/Desktop/My Computer/Coding Projects/three-vinyl/node_modules/react-three-gui/src/utils.ts","/Users/mitch/Desktop/My Computer/Coding Projects/three-vinyl/node_modules/react-three-gui/src/hooks/use-local-storage.ts","/Users/mitch/Desktop/My Computer/Coding Projects/three-vinyl/node_modules/react-three-gui/src/components/controls/base-control.tsx","/Users/mitch/Desktop/My Computer/Coding Projects/three-vinyl/node_modules/react-three-gui/src/components/controls/number-control.tsx","/Users/mitch/Desktop/My Computer/Coding Projects/three-vinyl/node_modules/react-three-gui/src/components/controls/boolean-control.tsx","/Users/mitch/Desktop/My Computer/Coding Projects/three-vinyl/node_modules/react-three-gui/src/components/controls/button-control.tsx","/Users/mitch/Desktop/My Computer/Coding Projects/three-vinyl/node_modules/react-three-gui/src/components/controls/color-control.tsx","/Users/mitch/Desktop/My Computer/Coding Projects/three-vinyl/node_modules/react-three-gui/src/components/controls/select-control.tsx","/Users/mitch/Desktop/My Computer/Coding Projects/three-vinyl/node_modules/react-three-gui/src/components/controls/string-control.tsx","/Users/mitch/Desktop/My Computer/Coding Projects/three-vinyl/node_modules/react-three-gui/src/components/controls/xy-pad-control.tsx","/Users/mitch/Desktop/My Computer/Coding Projects/three-vinyl/node_modules/react-three-gui/src/components/controls/file-control.tsx","/Users/mitch/Desktop/My Computer/Coding Projects/three-vinyl/node_modules/react-three-gui/src/components/control-item.tsx","/Users/mitch/Desktop/My Computer/Coding Projects/three-vinyl/node_modules/react-three-gui/src/components/control-group.tsx","/Users/mitch/Desktop/My Computer/Coding Projects/three-vinyl/node_modules/react-three-gui/src/components/controls.tsx","/Users/mitch/Desktop/My Computer/Coding Projects/three-vinyl/node_modules/react-three-gui/src/hooks/use-control.ts"],"sourcesContent":["import { createContext, RefObject, SetStateAction } from 'react';\nimport { ControlItem } from 'types';\n\ninterface IControlsContext {\n  values: RefObject<Map<string, any>>;\n  gui: RefObject<Map<string, SetStateAction<any>>>;\n  state: RefObject<Map<string, SetStateAction<any>>>;\n  controls: ControlItem[];\n  addControl(control: ControlItem): ControlItem;\n  removeControl(control: ControlItem): any;\n}\n\nexport const ControlsContext = createContext<IControlsContext>({\n  values: { current: new Map() },\n  gui: { current: new Map() },\n  state: { current: new Map() },\n  controls: [],\n  addControl(control: ControlItem) {\n    return control;\n  },\n  removeControl() {},\n});\n","import React, { useState, useRef } from 'react';\nimport { ControlsContext } from '../contexts/controls-context';\nimport { Canvas as R3FCanvas } from 'react-three-fiber';\nimport { ControlItem } from 'types';\n\nexport const ControlsProvider = ({\n  children,\n}: {\n  children: React.ReactNode;\n}) => {\n  const [controls, setControls] = useState<ControlItem[]>([]);\n  // Persist values between reloads\n  const values = useRef(new Map());\n  // GUI control state setters\n  const gui = useRef(new Map());\n  // useControl state setters\n  const state = useRef(new Map());\n\n  const context = {\n    values,\n    gui,\n    state,\n    controls,\n    addControl: (control: ControlItem) => {\n      control.id = String(Math.random());\n      setControls(ctrls => {\n        // control.id = control.id ?? String(ctrls.length);\n        return [...ctrls, control];\n      });\n      return control;\n    },\n    removeControl: (ctrl: ControlItem) => {\n      setControls(ctrls => ctrls.filter(c => c.id !== ctrl.id));\n    },\n  };\n\n  return (\n    <ControlsContext.Provider value={context}>\n      {children}\n    </ControlsContext.Provider>\n  );\n};\n\nexport function withControls(CanvasEl: typeof R3FCanvas) {\n  return ({ children, ...props }: any) => (\n    <ControlsContext.Consumer>\n      {value => (\n        <CanvasEl {...props}>\n          <ControlsContext.Provider value={value}>\n            {children}\n          </ControlsContext.Provider>\n        </CanvasEl>\n      )}\n    </ControlsContext.Consumer>\n  );\n}\n\nexport const Canvas = withControls(R3FCanvas);\n","import { Dispatch, SetStateAction, MouseEvent } from 'react';\nimport { SpringConfig } from '@react-spring/three';\n\nexport const DEFAULT_GROUP = 'DEFAULT_GROUP';\n\nexport type ControlItem = {\n  id: string;\n  name: string;\n  value: any;\n  options: ControlOptions;\n};\n\nexport enum ControlType {\n  NUMBER = 'number',\n  STRING = 'string',\n  BUTTON = 'button',\n  BOOLEAN = 'boolean',\n  SELECT = 'select',\n  COLOR = 'color',\n  XYPAD = 'xypad',\n  FILE = 'file',\n  CUSTOM = 'custom',\n}\n\nexport type ControlComponentProps<T> = ControlItem & {\n  setValue(value: any): void;\n  options: T;\n};\n\nexport type ControlOptionsBase = {\n  /** Unique id for control */\n  id?: string;\n  /* The control type */\n  type: ControlType | string;\n  /** Default value */\n  value?: any;\n  /* Return useSpring instead of useState */\n  spring?: boolean | SpringConfig;\n  /* Group this control */\n  group?: string;\n  /* Use your own state */\n  state?: [any, Dispatch<SetStateAction<any>>];\n  /* onChange callback */\n  onChange?(value: any): void;\n};\n\nexport type ControlOptionsNumber = {\n  type: ControlType.NUMBER | 'number';\n  /* Minimum value */\n  min?: number;\n  /* Maximum value */\n  max?: number;\n  /* Initial value */\n  value?: number;\n  /* Slider distance */\n  distance?: number;\n  /* Scrub value in both directions */\n  scrub?: boolean;\n};\n\nexport type ControlOptionsString = {\n  type: ControlType.STRING | 'string';\n  /* Initial value */\n  value?: string;\n};\n\nexport type ControlOptionsFile = {\n  type: ControlType.FILE | 'file';\n  /* Initial value */\n  value?: string;\n  /** Loader */\n  loader?: {\n    load(url: string): any;\n  };\n};\n\nexport type ControlOptionsButton = {\n  type: ControlType.BUTTON | 'button';\n  /* Fired on button click */\n  onClick?(e: MouseEvent<HTMLButtonElement>): any;\n};\n\nexport type ControlOptionsBoolean = {\n  type: ControlType.BOOLEAN | 'boolean';\n  value?: boolean;\n};\n\nexport type ControlOptionsSelect = {\n  type: ControlType.SELECT | 'select';\n  /* List of items to select from */\n  items: string[];\n  /* Initial value */\n  value?: string;\n};\n\nexport type ControlOptionsColor = {\n  type: ControlType.COLOR | 'color';\n  /* Initial value as HEX code */\n  value?: string;\n  /* Show picker as inline */\n  inline?: boolean;\n  /* What kind of picker. Default Chrome */\n  picker?:\n    | 'chrome'\n    | 'sketch'\n    | 'hue'\n    | 'alpha'\n    | 'block'\n    | 'github'\n    | 'twitter'\n    | 'circle'\n    | 'material'\n    | 'compact'\n    | 'slider'\n    | 'swatches';\n  /* Disable alpha */\n  disableAlpha?: boolean;\n  /* Custom set of colors */\n  colors?: string[];\n};\n\nexport type ControlOptionsXYPad = {\n  type: ControlType.XYPAD | 'xypad';\n  /* Initial value as { x, y } object */\n  value?: { x: number; y: number };\n  /* Pad drag distance */\n  distance?: number;\n  /* Scrub value in both directions */\n  scrub?: boolean;\n};\n\nexport type ControlOptionsCustom = {\n  type: ControlType.CUSTOM | 'custom';\n  /* Custom React component */\n  component?: any;\n};\n\nexport type ControlOptions = ControlOptionsBase &\n  (\n    | ControlOptionsCustom\n    | ControlOptionsNumber\n    | ControlOptionsBoolean\n    | ControlOptionsString\n    | ControlOptionsButton\n    | ControlOptionsColor\n    | ControlOptionsSelect\n    | ControlOptionsFile\n    | ControlOptionsXYPad\n  );\n","import { ControlOptions, ControlType } from './types';\nimport * as THREE from 'three';\n\nexport const defaultOptions: ControlOptions = {\n  type: ControlType.NUMBER,\n  value: 0,\n};\n\nexport const defaultValue = (options: ControlOptions) => {\n  if (options.hasOwnProperty('value')) {\n    return options.value;\n  }\n\n  switch (options.type) {\n    case ControlType.NUMBER:\n      return 0;\n    case ControlType.COLOR:\n      return '#ff0000';\n    case ControlType.STRING:\n      return '';\n    case ControlType.SELECT:\n      return (options.items || [''])[0];\n    case ControlType.BOOLEAN:\n      return false;\n    case ControlType.FILE:\n      return new THREE.FileLoader();\n    case ControlType.XYPAD:\n      return { x: 0, y: 0 };\n  }\n\n  return undefined;\n};\n\nexport const clamp = (num: number, clamp: number, higher?: number) =>\n  higher !== undefined\n    ? Math.min(Math.max(num, clamp), higher)\n    : Math.min(num, clamp);\n\nexport const map = (\n  value: number,\n  x1: number,\n  y1: number,\n  x2: number,\n  y2: number\n) => ((value - x1) * (y2 - x2)) / (y1 - x1) + x2;\n","import { useState } from 'react';\n\nexport function useLocalStorage(key: string, initialValue: any) {\n  const [storedValue, setStoredValue] = useState(() => {\n    try {\n      const item = window.localStorage.getItem(key);\n      return item ? JSON.parse(item) : initialValue;\n    } catch (error) {\n      console.log(error);\n      return initialValue;\n    }\n  });\n\n  const setValue = (value: any) => {\n    try {\n      const valueToStore =\n        value instanceof Function ? value(storedValue) : value;\n      setStoredValue(valueToStore);\n      window.localStorage.setItem(key, JSON.stringify(valueToStore));\n    } catch (error) {\n      console.log(error);\n    }\n  };\n\n  return [storedValue, setValue];\n}\n","import React from 'react';\nimport styled from 'styled-components';\n\ntype SCProps = {\n  stack?: boolean;\n  flexLabel?: boolean;\n};\n\nconst Row = styled.div`\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  padding: 8px 0;\n`;\n\nconst Label = styled.label<SCProps>`\n  display: flex;\n  font-family: sans-serif;\n  font-size: 14px;\n  color: rgba(0, 0, 0, 0.4);\n  width: 56px;\n  user-select: none;\n  ${props => (props.flexLabel === true ? 'flex: 1;' : '')}\n`;\n\nconst Content = styled.div<SCProps>`\n  display: flex;\n  ${props => (props.flexLabel !== true ? 'flex: 1;' : '')}\n  justify-content: flex-end;\n  padding: 0 8px;\n`;\n\nconst Value = styled.div<SCProps>`\n  display: flex;\n  font-family: sans-serif;\n  white-space: nowrap;\n  font-size: 14px;\n  color: rgba(0, 0, 0, 0.75);\n  justify-content: flex-end;\n  ${props => (props.stack ? 'flex: 1;' : '')}\n  ${props => (props.stack ? '' : 'width: 42px;')}\n`;\n\ntype BaseControlProps = {\n  label?: string;\n  flexLabel?: boolean;\n  value?: string;\n  children?: any;\n  stack?: boolean;\n  htmlFor?: any;\n};\n\nexport function BaseControl({\n  htmlFor,\n  label,\n  flexLabel,\n  value,\n  stack,\n  children,\n}: BaseControlProps) {\n  if (stack) {\n    return (\n      <div>\n        <Row>\n          <Label flexLabel={flexLabel}>{label}</Label>\n          <Value stack flexLabel={flexLabel}>\n            {value}\n          </Value>\n        </Row>\n        {children}\n      </div>\n    );\n  }\n\n  return (\n    <Row>\n      <Label flexLabel={flexLabel} htmlFor={htmlFor}>\n        {label}\n      </Label>\n      <Content flexLabel={flexLabel}>{children}</Content>\n      {typeof value !== 'undefined' && <Value>{value}</Value>}\n    </Row>\n  );\n}\n","import styled from 'styled-components';\nimport React, { useCallback, useEffect, useRef, useState } from 'react';\nimport { clamp, map } from '../../utils';\nimport { BaseControl } from './base-control';\nimport { ControlComponentProps, ControlOptionsNumber } from '../../types';\n\nconst InputRange = styled.input`\n  -webkit-appearance: none;\n  width: 100%;\n  background: transparent;\n  display: inline-block;\n\n  &:focus {\n    outline: none;\n  }\n\n  &::-webkit-slider-runnable-track {\n    width: 100%;\n    height: 12px;\n    cursor: pointer;\n    background: rgba(0, 0, 0, 0.045);\n    border-radius: 10px;\n  }\n\n  &::-webkit-slider-thumb {\n    border: none;\n    height: 20px;\n    width: 20px;\n    border-radius: 50%;\n    background: #ffffff;\n    cursor: pointer;\n    box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.22);\n    -webkit-appearance: none;\n    margin-top: -4px;\n  }\n\n  &:focus::-webkit-slider-runnable-track {\n    outline: none;\n  }\n`;\n\nconst PRECISION = 300;\nconst CENTER = PRECISION / 2;\n\nexport const NumberControl = ({\n  name,\n  value,\n  setValue,\n  options,\n}: ControlComponentProps<ControlOptionsNumber>) => {\n  const ref = useRef<HTMLInputElement | null>(null);\n  const stage = useRef(null);\n  const {\n    min = options.scrub ? -Infinity : 0,\n    max = options.scrub ? Infinity : Math.PI,\n  } = options;\n\n  const distance = options.distance ?? options.scrub ? 2 : max - min;\n\n  const [val, setVal] = useState(\n    options.scrub ? CENTER : map(value, min, max, 0, PRECISION)\n  );\n\n  const handleChange = useCallback(() => {\n    if (options.scrub) {\n      setVal(CENTER);\n      stage.current = null;\n    }\n  }, [options.scrub]);\n\n  useEffect(() => {\n    const el = ref.current;\n    if (el) {\n      el.addEventListener('change', handleChange);\n    }\n    return () => {\n      if (el) {\n        el.removeEventListener('change', handleChange);\n      }\n    };\n  }, [handleChange, ref]);\n\n  return (\n    <BaseControl label={name} value={(value || 0).toFixed(2)}>\n      <InputRange\n        ref={ref}\n        type=\"range\"\n        value={val}\n        min={0}\n        max={PRECISION}\n        onChange={e => {\n          const num = Number(e.target.value);\n          setVal(num);\n          if (stage.current === null) {\n            stage.current = value;\n          }\n          const cvalue =\n            (options.scrub ? (stage as any).current : 0) +\n            map(\n              num - (options.scrub ? CENTER : 0),\n              0,\n              PRECISION,\n              options.scrub ? 0 : min,\n              options.scrub ? distance * 2 : max\n            );\n          setValue(clamp(cvalue, min, max));\n        }}\n      />\n    </BaseControl>\n  );\n};\n","import React from \"react\";\nimport styled from \"styled-components\";\nimport { BaseControl } from \"./base-control\";\nimport { ControlComponentProps, ControlOptionsBoolean } from \"../../types\";\n\nconst FakeCheckbox = styled.label`\n  height: 16px;\n  width: 16px;\n  border: 2px solid rgba(0, 0, 0, 0.065);\n  border-radius: 4px;\n  position: relative;\n  margin-top: -1px;\n  transition: ease-in-out 125ms;\n  transition-property: background-color, border-color;\n`;\n\nconst Checkbox = styled.input`\n  opacity: 0;\n  margin-right: -15px;\n  & + ${FakeCheckbox}:after {\n    position: absolute;\n    content: \"\";\n    display: inline-block;\n    height: 4px;\n    width: 8px;\n    border-left: 2px solid;\n    border-bottom: 2px solid;\n    left: 3px;\n    top: 4px;\n    opacity: 0;\n    transform: translate(0px, 2px) rotate(-45deg);\n    transition: ease-in-out 125ms;\n    transition-property: opacity, transform;\n  }\n  &:checked + ${FakeCheckbox}:after {\n    opacity: 1;\n    transform: translate(0px, 0px) rotate(-45deg);\n  }\n  &:checked + ${FakeCheckbox} {\n    background: rgba(0, 0, 0, 0.045);\n    border-color: rgba(0, 0, 0, 0.085);\n  }\n`;\n\nexport function BooleanControl({\n  id,\n  name,\n  value,\n  setValue\n}: ControlComponentProps<ControlOptionsBoolean>) {\n  const htmlFor = `Control${id}`;\n  return (\n    <BaseControl flexLabel label={name} htmlFor={htmlFor}>\n      <Checkbox\n        id={htmlFor}\n        type=\"checkbox\"\n        checked={value}\n        onChange={(e) => setValue(e.currentTarget.checked)}\n      />\n      <FakeCheckbox htmlFor={htmlFor} />\n    </BaseControl>\n  );\n}\n","import React, { MouseEvent } from 'react';\nimport styled from 'styled-components';\nimport { ControlComponentProps, ControlOptionsButton } from '../../types';\n\nconst Button = styled.button`\n  display: block;\n\n  font-family: sans-serif;\n  font-size: 14px;\n  color: rgba(0, 0, 0, 0.4);\n\n  display: block;\n  position: relative;\n\n  width: 100%;\n  height: 32px;\n\n  color: #000;\n\n  border: 0;\n  background-color: rgba(0, 0, 0, 0.045);\n  border-radius: 4px;\n  padding: 0 4px;\n`;\n\nexport function ButtonControl({\n  name,\n  options,\n}: ControlComponentProps<ControlOptionsButton>) {\n  return (\n    <div style={{ paddingTop: 8, paddingBottom: 8 }}>\n      <Button\n        onClick={(e: MouseEvent<HTMLButtonElement>) => {\n          if (options.onClick) {\n            options.onClick(e);\n          }\n        }}\n      >\n        {name}\n      </Button>\n    </div>\n  );\n}\n","import React, { useEffect, useRef, useState } from 'react';\nimport {\n  AlphaPicker,\n  BlockPicker,\n  ChromePicker,\n  CirclePicker,\n  CompactPicker,\n  GithubPicker,\n  HuePicker,\n  MaterialPicker,\n  SketchPicker,\n  SliderPicker,\n  SwatchesPicker,\n  TwitterPicker,\n} from 'react-color';\nimport styled from 'styled-components';\nimport { BaseControl } from './base-control';\nimport { ControlComponentProps, ControlOptionsColor } from '../../types';\n\nconst ColorPicker = styled.div`\n  position: relative;\n\n  > div {\n    box-sizing: border-box !important;\n  }\n`;\n\nconst ColorBox = styled.div`\n  width: 32px;\n  height: 16px;\n  border: 2px solid white;\n  box-shadow: 0 0 1px 0 rgba(0, 0, 0, 0.3);\n  cursor: pointer;\n`;\n\nconst Picker = styled.div<{ hidden: boolean }>`\n  position: absolute;\n  top: 24px;\n  right: 0px;\n  z-index: 100;\n`;\n\nexport function ColorControl({\n  name,\n  value,\n  setValue,\n  options,\n}: ControlComponentProps<ControlOptionsColor>) {\n  const { inline = false, picker = 'chrome' } = options;\n  const [open, setOpen] = useState(false);\n  const pickerRef = useRef<HTMLDivElement>();\n  const handleClick = (e: any) => {\n    if (pickerRef.current && !pickerRef.current.contains(e.target)) {\n      setOpen(false);\n    }\n  };\n\n  useEffect(() => {\n    document.body.addEventListener('click', handleClick);\n    return () => {\n      document.body.removeEventListener('click', handleClick);\n    };\n  }, []);\n\n  const pickerProps: any = {\n    color: value,\n    onChange: (color: any) => setValue(color.rgb),\n    disableAlpha: options.disableAlpha,\n    colors: options.colors,\n  };\n\n  let PickerElement: any = ChromePicker;\n\n  switch (picker) {\n    case 'alpha':\n      PickerElement = AlphaPicker;\n      break;\n    case 'block':\n      PickerElement = BlockPicker;\n      break;\n    case 'circle':\n      PickerElement = CirclePicker;\n      break;\n    case 'compact':\n      PickerElement = CompactPicker;\n      break;\n    case 'github':\n      PickerElement = GithubPicker;\n      break;\n    case 'hue':\n      PickerElement = HuePicker;\n      break;\n    case 'material':\n      PickerElement = MaterialPicker;\n      break;\n    case 'sketch':\n      PickerElement = SketchPicker;\n      pickerProps.presetColors = options.colors;\n      break;\n    case 'slider':\n      PickerElement = SliderPicker;\n      break;\n    case 'swatches':\n      PickerElement = SwatchesPicker;\n      break;\n    case 'twitter':\n      PickerElement = TwitterPicker;\n      break;\n  }\n\n  return (\n    <BaseControl stack={inline} label={name} flexLabel>\n      <ColorPicker>\n        {inline ? (\n          <PickerElement\n            {...pickerProps}\n            triangle={inline ? 'hide' : undefined}\n            width={268}\n          />\n        ) : (\n          <>\n            <ColorBox\n              style={{ backgroundColor: value }}\n              onClick={() => setOpen(lastValue => !lastValue)}\n            />\n            <Picker hidden={open !== true} ref={pickerRef as any}>\n              <PickerElement {...pickerProps} />\n            </Picker>\n          </>\n        )}\n      </ColorPicker>\n    </BaseControl>\n  );\n}\n","import React from 'react';\nimport styled from 'styled-components';\nimport { BaseControl } from './base-control';\nimport { ControlComponentProps, ControlOptionsSelect } from '../../types';\n\nconst Select = styled.select`\n  display: block;\n\n  font-family: sans-serif;\n  font-size: 14px;\n  color: rgba(0, 0, 0, 0.4);\n\n  display: block;\n  position: relative;\n\n  width: 100%;\n  height: 32px;\n\n  color: #000;\n\n  margin-left: 8px;\n\n  border: 0;\n  background-color: rgba(0, 0, 0, 0.025);\n  border-radius: 4px;\n  padding: 0 4px;\n`;\n\nexport function SelectControl({\n  name,\n  setValue,\n  value,\n  options,\n}: ControlComponentProps<ControlOptionsSelect>) {\n  const { items = [] } = options;\n  return (\n    <BaseControl label={name}>\n      <Select value={value} onChange={e => setValue(e.currentTarget.value)}>\n        {items.map((item: string, i: number) => (\n          <option key={i}>{item}</option>\n        ))}\n      </Select>\n    </BaseControl>\n  );\n}\n","import React from 'react';\nimport styled from 'styled-components';\nimport { BaseControl } from './base-control';\nimport { ControlComponentProps, ControlOptionsString } from '../../types';\n\nconst Input = styled.input`\n  display: block;\n\n  font-family: sans-serif;\n  font-size: 14px;\n  color: rgba(0, 0, 0, 0.4);\n\n  display: block;\n  position: relative;\n\n  width: 100%;\n  height: 32px;\n\n  color: #000;\n\n  margin-left: 8px;\n\n  border: 0;\n  background-color: rgba(0, 0, 0, 0.025);\n  border-radius: 4px;\n  padding: 0 4px;\n`;\n\nexport const StringControl = React.memo(\n  ({ name, setValue, value }: ControlComponentProps<ControlOptionsString>) => {\n    return (\n      <BaseControl label={name}>\n        <Input value={value} onChange={e => setValue(e.target.value)} />\n      </BaseControl>\n    );\n  }\n);\n","import React, { useRef } from 'react';\nimport { animated, useSpring, to } from '@react-spring/web';\nimport { useDrag } from 'react-use-gesture';\nimport useMeasure from 'react-use-measure';\nimport { clamp, map } from '../../utils';\nimport { BaseControl } from './base-control';\nimport { ControlComponentProps, ControlOptionsXYPad } from '../../types';\n\n// When to just show 0 instead of 0.000000012333\nconst THRESHOLD = 0.00001;\n\nexport const XYPadControl = ({\n  name,\n  value,\n  setValue,\n  options,\n}: ControlComponentProps<ControlOptionsXYPad>) => {\n  const stage = useRef(null);\n  const { distance = 1, scrub = false } = options;\n  const [ref, { width, height }] = useMeasure();\n\n  const [cursor, setCursor] = useSpring(\n    () => ({\n      from: {\n        x: value.x,\n        y: value.y,\n      },\n\n      onChange(value: any, b: any) {\n        const clampMx = b.key === 'x' ? width : height;\n        const v =\n          clamp(map(value, 0, clampMx / 2, 0, distance), -distance, distance) ||\n          0;\n        if (!scrub) {\n          setValue((prev: any) => ({\n            ...prev,\n            [b.key]: v < THRESHOLD && v > -THRESHOLD ? 0 : v,\n          }));\n        }\n      },\n    }),\n    [width, height]\n  ) as any;\n\n  const bind = useDrag(({ down, movement }) => {\n    if (down && !stage.current) {\n      stage.current = value;\n    } else if (!down) {\n      stage.current = null;\n    }\n\n    setCursor({ x: down ? movement[0] : 0, y: down ? movement[1] : 0 });\n\n    if (scrub) {\n      if (down) {\n        setValue(() => ({\n          x:\n            (stage as any).current.x +\n            map(movement[0], 0, width / 2, 0, distance),\n          y:\n            (stage as any).current.y +\n            map(movement[1], 0, height / 2, 0, distance),\n        }));\n      } else {\n        stage.current = value;\n      }\n    }\n  });\n\n  const x = cursor.x.to((n: number) => clamp(n + width / 2, 0, width));\n  const y = cursor.y.to((n: number) => clamp(n + height / 2, 0, height));\n\n  return (\n    <BaseControl\n      stack\n      label={name}\n      value={`x: ${value.x.toFixed(1)}, y: ${value.y.toFixed(1)}`}\n    >\n      <animated.svg\n        ref={ref as any}\n        style={{\n          userSelect: 'none',\n          borderRadius: 8,\n          border: '1px solid #f0f0f0',\n        }}\n        width=\"100%\"\n        height={200}\n        xmlns=\"http://www.w3.org/2000/svg\"\n        {...bind()}\n      >\n        <rect fill=\"rgb(250, 250, 250)\" width=\"100%\" height=\"100%\" />\n        <animated.line x1={x} x2={x} y1={0} y2=\"100%\" stroke=\"#ccc\" />\n        <animated.line x1={0} x2=\"100%\" y1={y} y2={y} stroke=\"#ccc\" />\n        <animated.g\n          style={{\n            transform: to([x, y], (x, y) => `translate(${x}px, ${y}px)`),\n          }}\n        >\n          <circle r={8} fill=\"#ccc\" />\n          <circle r={4} fill=\"#aaa\" />\n        </animated.g>\n      </animated.svg>\n    </BaseControl>\n  );\n};\n","import React from 'react';\nimport styled from 'styled-components';\nimport { BaseControl } from './base-control';\nimport { ControlComponentProps, ControlOptionsFile } from '../../types';\nimport * as THREE from 'three';\n\nconst FileInput = styled.input`\n  width: 100%;\n`;\n\nexport const FileControl = ({\n  name,\n  setValue,\n  options,\n}: ControlComponentProps<ControlOptionsFile>) => {\n  return (\n    <BaseControl label={name}>\n      <FileInput\n        type=\"file\"\n        onChange={e => {\n          const loader = options.loader ?? new THREE.FileLoader();\n          if ((loader as any).setCrossOrigin) {\n            (loader as THREE.TextureLoader).setCrossOrigin('');\n          }\n          const file = e.currentTarget.files && e.currentTarget.files[0];\n          const texture = loader.load(URL.createObjectURL(file));\n          setValue(texture);\n        }}\n      />\n    </BaseControl>\n  );\n};\n","import React, { useContext, useEffect, useState } from 'react';\nimport { ControlsContext } from '../contexts/controls-context';\nimport {\n  ControlType,\n  ControlOptions,\n  ControlComponentProps,\n  ControlOptionsCustom,\n} from '../types';\nimport { NumberControl } from './controls/number-control';\nimport { BooleanControl } from './controls/boolean-control';\nimport { BaseControl } from './controls/base-control';\nimport { ButtonControl } from './controls/button-control';\nimport { ColorControl } from './controls/color-control';\nimport { SelectControl } from './controls/select-control';\nimport { StringControl } from './controls/string-control';\nimport { XYPadControl } from './controls/xy-pad-control';\nimport { FileControl } from './controls/file-control';\n\nconst ControlComponents = {\n  [ControlType.NUMBER]: NumberControl,\n  [ControlType.BOOLEAN]: BooleanControl,\n  [ControlType.SELECT]: SelectControl,\n  [ControlType.COLOR]: ColorControl,\n  [ControlType.STRING]: StringControl,\n  [ControlType.BUTTON]: ButtonControl,\n  [ControlType.FILE]: FileControl,\n  [ControlType.XYPAD]: XYPadControl,\n};\n\nconst Noop = ({ name, options }: any) => (\n  <BaseControl label={name}>\"{options.type}\" not found</BaseControl>\n);\n\nexport const ControlItem = ({\n  name,\n  id,\n  value: defaultValue,\n  options,\n}: ControlComponentProps<ControlOptions>) => {\n  const context = useContext(ControlsContext);\n\n  const [value, setValue] = useState(\n    context.values.current && context.values.current.has(id)\n      ? context.values.current.get(id)\n      : defaultValue\n  );\n\n  useEffect(() => {\n    context.values.current!.set(id, value);\n  }, [context.values, id, value]);\n\n  useEffect(() => {\n    context.gui.current!.set(id, setValue);\n  }, [context.gui, id]);\n\n  const Component =\n    (options as ControlOptionsCustom).component ??\n    (ControlComponents as any)[options.type ?? ControlType.NUMBER] ??\n    Noop;\n\n  return (\n    <Component\n      id={id}\n      name={name}\n      value={value}\n      setValue={(newValue: any) => {\n        context.gui.current?.get(id)?.(newValue);\n        context.state.current?.get(id)?.(newValue);\n      }}\n      options={options}\n    />\n  );\n};\n","import React, { useState } from 'react';\nimport styled from 'styled-components';\nimport { ControlItem } from './control-item';\n\nconst Heading = styled.h2<{ open: boolean }>`\n  display: block;\n  font-family: sans-serif;\n  font-size: 13px;\n  font-weight: bold;\n  padding-left: 16px;\n  cursor: pointer;\n  position: relative;\n  user-select: none;\n\n  &:before,\n  &:after {\n    content: '';\n    position: absolute;\n    top: 8px;\n    right: 16px;\n    width: 12px;\n    height: 2px;\n    background-color: #333;\n    /* transition: transform 0.25s ease-out; */\n  }\n  &:before {\n    transform: rotate(${props => (props.open ? 0 : 90)}deg);\n  }\n\n  &:after {\n    transform: rotate(${props => (props.open ? 0 : 180)}deg);\n  }\n`;\n\nconst Container = styled.div<{ open: boolean; bg: boolean }>`\n  background: ${props => (props.bg ? '#f9f9f9' : '#fff')};\n  padding: 16px;\n  display: ${props => (props.open ? 'block' : 'none')};\n  margin-bottom: 8px;\n`;\n\nexport const ControlGroup = ({ title, controls, options = {} }: any) => {\n  const [open, setOpen] = useState(!options.defaultClosed ?? true);\n  const isDefault = title !== 'DEFAULT_GROUP';\n  return (\n    <div>\n      {isDefault && (\n        <Heading open={open} onClick={() => setOpen(o => !o)}>\n          {title}\n        </Heading>\n      )}\n      <Container open={open} bg={isDefault}>\n        {Array.from(controls).map((control: any) => (\n          <ControlItem key={`${control.id}_${control.name}`} {...control} />\n        ))}\n      </Container>\n    </div>\n  );\n};\n","import React, { useContext } from 'react';\nimport { ControlsProvider, Canvas } from './controls-provider';\nimport styled from 'styled-components';\nimport { animated, useSpring, to } from '@react-spring/web';\nimport { useDrag } from 'react-use-gesture';\nimport useMeasure from 'react-use-measure';\nimport { clamp } from '../utils';\nimport { DEFAULT_GROUP } from '../types';\nimport { ControlsContext } from '../contexts/controls-context';\nimport { useLocalStorage } from '../hooks/use-local-storage';\nimport { ControlGroup } from './control-group';\n\nconst mq = `@media only screen and (max-width: 600px)`;\n\ninterface FloatProps {\n  'data-width': number;\n  'data-anchor': ControlsAnchor | string;\n}\n\nexport enum ControlsAnchor {\n  TOP_LEFT = 'top_left',\n  TOP_RIGHT = 'top_right',\n  BOTTOM_LEFT = 'bottom_left',\n  BOTTOM_RIGHT = 'bottom_right',\n}\n\nexport interface ControlsProps {\n  /**\n   * Title to show on the controls\n   */\n  title?: string;\n  /**\n   * Collapsed by default\n   */\n  collapsed?: boolean;\n  /**\n   * Array of group names as strings\n   */\n  defaultClosedGroups?: string[];\n  /**\n   * Defaults to 300\n   */\n  width?: number;\n  /**\n   * Anchor point\n   */\n  anchor?:\n    | ControlsAnchor\n    | 'top_left'\n    | 'bottom_left'\n    | 'top_right'\n    | 'bottom_right';\n  /**\n   * Styles\n   */\n  style?: any;\n}\n\nfunction posProps(positions: ControlsAnchor[]) {\n  return function posPropsFn(props: any) {\n    return positions.includes(props['data-anchor']) ? '16px' : 'auto';\n  };\n}\n\nconst Float = styled(animated.div)<FloatProps>`\n  display: flex;\n  flex-direction: column;\n  position: fixed;\n  top: ${posProps([ControlsAnchor.TOP_LEFT, ControlsAnchor.TOP_RIGHT])};\n  right: ${posProps([ControlsAnchor.BOTTOM_RIGHT, ControlsAnchor.TOP_RIGHT])};\n  bottom: ${posProps([\n    ControlsAnchor.BOTTOM_RIGHT,\n    ControlsAnchor.BOTTOM_LEFT,\n  ])};\n  left: ${posProps([ControlsAnchor.TOP_LEFT, ControlsAnchor.BOTTOM_LEFT])};\n  width: ${props => props['data-width']}px;\n  border-radius: 16px;\n  background-color: #fff;\n  border-radius: 8px;\n  box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.12);\n\n  ${mq} {\n    transform: none !important;\n    flex-direction: column-reverse;\n    top: auto;\n    bottom: 0;\n    left: 0;\n    right: 0;\n    width: auto;\n  }\n`;\n\nconst Header = styled(animated.div)<{ 'data-collapsed': boolean }>`\n  display: flex;\n  align-items: center;\n  position: relative;\n  padding-left: 16px;\n  padding-right: 16px;\n  height: 42px;\n  font-family: sans-serif;\n  font-size: 14px;\n  color: #fff;\n  cursor: move;\n  cursor: grab;\n  user-select: none;\n  background-color: #000;\n  border-top-left-radius: 8px;\n  border-top-right-radius: 8px;\n  border-bottom-left-radius: ${props => (props['data-collapsed'] ? 0 : 8)}px;\n  border-bottom-right-radius: ${props => (props['data-collapsed'] ? 0 : 8)}px;\n  box-shadow: 0 0 14px 0 rgba(0, 0, 0, 0.14);\n  ${mq} {\n    border-top-left-radius: 0px;\n    border-top-right-radius: 0px;\n    border-bottom-left-radius: 0px;\n    border-bottom-right-radius: 0px;\n  }\n`;\n\nconst CollapseIcon = styled.div<{ collapsed: boolean }>`\n  width: 30px;\n  height: 18px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  margin-left: auto;\n  cursor: pointer;\n  &:after {\n    content: '';\n    display: block;\n    height: 3px;\n    width: 16px;\n    background-color: white;\n  }\n  ${mq} {\n    &:before {\n      content: '';\n      display: block;\n      position: absolute;\n      top: 0;\n      right: 0;\n      bottom: 0;\n      left: 0;\n    }\n  }\n`;\n\nconst Items = styled(animated.div)`\n  padding-bottom: 8px;\n  overflow-y: auto;\n  max-height: calc(100vh - 42px);\n`;\n\nconst groupByGroup = (items: any): any => {\n  return Array.from(items).reduce((acc: any, item: any) => {\n    const groupName = item?.options?.group || DEFAULT_GROUP;\n    acc[groupName] = acc[groupName] || [];\n    acc[groupName].push(item);\n    return acc;\n  }, {} as { [key: string]: any });\n};\n\ninterface ControlsFn {\n  (props: ControlsProps): JSX.Element;\n  Provider: typeof ControlsProvider;\n  Canvas: typeof Canvas;\n}\n\nexport const Controls: ControlsFn = (props: ControlsProps) => {\n  const {\n    title = 'react-three-gui',\n    defaultClosedGroups = [],\n    width = 300,\n    style = {},\n    anchor = ControlsAnchor.TOP_RIGHT,\n  } = props;\n  const { controls } = useContext(ControlsContext);\n  const [collapsed, setCollapsed] = useLocalStorage(\n    'REACT_THREE_GUI__COLLAPSED',\n    props.collapsed\n  );\n  const [position, setPosition] = useLocalStorage(\n    `REACT_THREE_GUI__${anchor}`,\n    [0, 0]\n  );\n  const [ref, bounds] = useMeasure();\n  const [{ pos }, setPos] = useSpring(() => ({\n    pos: position,\n    onRest({ value }) {\n      setPosition(value);\n    },\n  }));\n  const left = [ControlsAnchor.TOP_LEFT, ControlsAnchor.BOTTOM_LEFT].includes(\n    anchor as any\n  );\n  const top = [ControlsAnchor.TOP_RIGHT, ControlsAnchor.TOP_LEFT].includes(\n    anchor as any\n  );\n  const bind = useDrag(\n    ({\n      movement,\n      memo = pos\n        ? (pos as any).getValue\n          ? (pos as any).getValue()\n          : (pos as any).get()\n        : 0,\n    }) => {\n      const [x, y] = [movement[0] + memo[0], movement[1] + memo[1]];\n      setPos({\n        pos: [\n          left\n            ? clamp(x, 1, window.innerWidth - width - 32)\n            : clamp(x, -window.innerWidth + width + 32, 1),\n          top\n            ? clamp(y, 1, window.innerHeight)\n            : clamp(y, -window.innerHeight + bounds.height + 32, 1),\n        ],\n      });\n      return memo;\n    }\n  );\n\n  const getGroupOptions = (groupName: string): any => {\n    return {\n      defaultClosed: defaultClosedGroups?.includes(groupName) ?? false,\n    };\n  };\n\n  const groups = groupByGroup(controls);\n\n  return (\n    <Float\n      data-width={width}\n      data-anchor={anchor}\n      ref={ref}\n      style={{\n        ...style,\n        transform: to(\n          [pos] as any,\n          ([x, y]) => `translate3d(${x}px,${y}px,0)` as any\n        ),\n      }}\n    >\n      <Header data-collapsed={collapsed} {...bind()}>\n        {title}\n        <CollapseIcon\n          collapsed={collapsed}\n          onClick={() => setCollapsed((c: boolean) => !c)}\n        />\n      </Header>\n      <Items\n        hidden={!collapsed}\n        style={{\n          maxHeight: top\n            ? to([pos] as any, ([_, y]) => `calc(100vh - ${y + 92}px)` as any)\n            : undefined,\n        }}\n      >\n        {Object.entries(groups).map(([groupName, items]: any) => (\n          <ControlGroup\n            key={groupName}\n            title={groupName}\n            controls={items}\n            options={getGroupOptions(groupName)}\n          />\n        ))}\n      </Items>\n    </Float>\n  );\n};\n\nControls.Provider = ControlsProvider;\nControls.Canvas = Canvas;\n","import { useState, useEffect, useContext } from 'react';\nimport { useSpring } from '@react-spring/three';\nimport { ControlsContext } from '../contexts/controls-context';\nimport { ControlOptions, ControlItem } from '../types';\nimport { defaultOptions, defaultValue } from '../utils';\n\nexport const useControl = (\n  name: string,\n  options: ControlOptions = defaultOptions\n) => {\n  const context = useContext(ControlsContext);\n  const [id, setId] = useState<string | null>(null);\n  let [value, setValue] = useState(defaultValue(options));\n\n  const [spring, setSpring] = useSpring(() => ({\n    value,\n    config: typeof options.spring === 'object' ? options.spring : undefined,\n  }));\n  const setSpringValue = (springValue: any) =>\n    setSpring({ value: springValue });\n\n  if (options.state) {\n    value = options.state[0];\n    setValue = options.state[1];\n  }\n\n  useEffect(() => {\n    if (context.state.current && id) {\n      if (options.spring) {\n        context.state.current.set(id, setSpringValue);\n      } else {\n        context.state.current.set(id, setValue);\n      }\n    }\n  }, [context.state, id]);\n\n  useEffect(() => {\n    const ctrl = context.addControl({\n      id: options.id,\n      name,\n      value,\n      options,\n    } as ControlItem);\n    setId(ctrl.id);\n    return () => {\n      context.removeControl(ctrl);\n    };\n  }, []);\n\n  useEffect(() => {\n    options.spring && void setSpring({ value });\n    options.onChange && void options.onChange(value);\n  }, [options, setSpring, value]);\n\n  if (options.spring) {\n    return spring.value;\n  }\n\n  return value;\n};\n"]},"metadata":{},"sourceType":"module"}